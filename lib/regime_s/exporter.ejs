<%
/*
 // Create a new workbook file in current working-path
  var workbook = excelbuilder.createWorkbook('./', 'sample.xlsx')

  // Create a new worksheet with 10 columns and 12 rows
  var sheet1 = workbook.createSheet('sheet1', 200, 220);
 
sheet1.width(1, 15);

  // Fill some data
for(var j = 1;j <= data2.length;j++) {
  
  
  sheet1.set(1, j,data2[j].nom_boucle.toString(););

   sheet1.set(2, j, 'Source');
    sheet1.set(3, j, 'Poste 1');
sheet1.set(4, j, 'Poste 1');
  sheet1.set(5, j, 'Longueur');
  sheet1.width(6, 17);
     sheet1.set(6, j, 'Section cable');
sheet1.width(7, 17);
   sheet1.set(7, j, 'Niveau tension');
   sheet1.width(8, 17);
      sheet1.set(8, j, 'Coefficient');
      sheet1.width(9, 17);
      sheet1.set(9, j, 'Puissance point');
      sheet1.width(10, 17);
      sheet1.set(10, j, 'Puissance cumulee');
      
   sheet1.set(11, j, 'Intensite');
   sheet1.width(12, 17);
sheet1.set(12, j, 'Chute tension');
sheet1.width(13, 17);
sheet1.set(13, j, 'Delta cumulee');
sheet1.set(14, j, 'Delta U');
for(var i = 2;i <= data.length+1;i++) {
 if(data[i].nom_boucle.toString('utf-8').trim() == data2[j].nom_boucle.toString('utf-8').trim()){
  sheet1.set(1, i, data[i].id_calcule);
   sheet1.set(2, i, data[i].id_source);
    sheet1.set(3, i, data[i].PT01);
sheet1.set(4, i, data[i].PT02);
  sheet1.set(5, i, data[i].longueur);
   sheet1.set(6, i, data[i].section_cable);
      sheet1.set(7, i, data[i].niveau_tension);
      sheet1.set(8, i, data[i].coefficient);
      sheet1.set(9, i, data[i].puissance_point);
   sheet1.set(10, i,data[i].puissance_cumulee);
sheet1.set(11, i, data[i].intensite);
sheet1.set(12, i, data[i].chute_tension);
sheet1.set(13, i, data[i].delta_cumulee);
sheet1.set(14, i, data[i].data[i].delta_u);

    } }
}

  // Save it
  workbook.save(function(err){
    if (err)
      throw err;
    else
      console.log('congratulations, your workbook created');
  });

*/


    var writeStream = fs.createWriteStream("../file.xls");
for(var j = 0;j < data2.length;j++) {
var head=data2[j].nom_boucle+"\n";
var header="Id calcule"+"\t"+"Source"+"\t"+"Poste 1"+"\t"+"Poste 2"+"\t"+"Longueur"+"\t"+"Section cable"+"\t"+"Niveau tension"+"\t"+"Coefficient"+"\t"+"Puissance point"+"\t"+"Puissance cumulee"+"\t"+"Intensite"+"\t"+"Chute tension"+"\t"+"Delta cumulee"+"\t"+"Delta U"+"\n";
writeStream.write(head);

writeStream.write(header);
    for(var i = 0;i < data.length;i++) {
    if(data[i].nom_boucle.toString('utf-8').trim() == data2[j].nom_boucle.toString('utf-8').trim()){

var row1=data[i].id_calcule+"\t"+data[i].id_source+"\t"+data[i].PT01+"\t"+data[i].PT02+"\t"+data[i].longueur+"\t"+data[i].section_cable+"\t"+data[i].niveau_tension+"\t"+data[i].coefficient+"\t"+data[i].puissance_point+"\t"+data[i].puissance_cumulee+"\t"+data[i].intensite+"\t"+data[i].chute_tension+"\t"+data[i].delta_cumulee+"\t"+data[i].delta_u+"\n";


writeStream.write(row1);


    } }
}




for(var e = 0;e < data3.length;e++) {
var head1=data3[e].nom_boucle+"\n";
var header1="Id calcule"+"\t"+"Source"+"\t"+"Poste 1"+"\t"+"Poste 2"+"\t"+"Longueur"+"\t"+"Section cable"+"\t"+"Niveau tension"+"\t"+"Coefficient"+"\t"+"Puissance point"+"\t"+"Puissance cumulee"+"\t"+"Intensite"+"\t"+"Chute tension"+"\t"+"Delta cumulee"+"\t"+"Delta U"+"\n";
writeStream.write(head1);
writeStream.write(header1);
    for(var k = 0;k < data4.length;k++) {
    if(data4[k].nom_boucle.toString('utf-8').trim() == data3[e].nom_boucle.toString('utf-8').trim()){

var row2=data4[k].id_calcule+"\t"+data4[k].id_source+"\t"+data4[k].PT01+"\t"+data4[k].PT02+"\t"+data4[k].longueur+"\t"+data4[k].section_cable+"\t"+data4[k].niveau_tension+"\t"+data4[k].coefficient+"\t"+data4[k].puissance_point+"\t"+data4[k].puissance_cumulee+"\t"+data4[k].intensite+"\t"+data4[k].chute_tension+"\t"+data4[k].delta_cumulee+"\t"+data4[k].delta_u+"\n";


writeStream.write(row2);


    } }
}


%>

